<?php
// Routes


require_once __DIR__ . '/Model/UserObject.php';




/*
 * 登录模块
 * */
require_once __DIR__ . '/Controller/auth.php';

$app->post('/auth/login', function ($request, $response, $args) {
	return handleLogin($this,$request, $response, $args);
});

$app->post('/auth/logout', function ($request, $response, $args) {
	return handleLogout($this,$request, $response, $args);
});


/*
 * 用户管理模块
 * */
require_once __DIR__ . '/Controller/account.php';
$app->post('/account/create', function ($request, $response, $args) {
	return handle_account_create($this,$request, $response, $args);
});

$app->post('/account/modify', function ($request, $response, $args) {
	return handle_account_modify($this,$request, $response, $args);
});

$app->post('/account/delete', function ($request, $response, $args) {
	return handle_account_delete($this,$request, $response, $args);
});

$app->get('/account/info', function ($request, $response, $args) {
	return handle_account_info($this,$request, $response, $args);
});

$app->get('/account/listall', function ($request, $response, $args) {
	return handle_account_listall($this,$request, $response, $args);
});

$app->post('/account/changepsw', function ($request, $response, $args) {
	return handle_account_changepsw($this,$request, $response, $args);
});

/*
 * 客户管理
 * */
require_once __DIR__ . '/Controller/customer.php';

$app->get('/customer/availableid', function ($request, $response, $args) {
	return handle_customer_availableid($this,$request, $response, $args);
});

$app->post('/customer/create', function ($request, $response, $args) {
	return handle_customer_create($this,$request, $response, $args);
});
$app->post('/customer/delete', function ($request, $response, $args) {
	return handle_customer_delete($this,$request, $response, $args);
});
$app->get('/customer/search', function ($request, $response, $args) {
	return handle_customer_search($this,$request, $response, $args);
});
$app->get('/customer/info', function ($request, $response, $args) {
	return handle_customer_info($this,$request, $response, $args);
});
$app->get('/customer/tocsv', function ($request, $response, $args) {
	return handle_customer_tocsv($this,$request, $response, $args);
});
$app->post('/customer/update', function ($request, $response, $args) {
	return handle_customer_update($this,$request, $response, $args);
});


/*
 * 墓位配置管理
 * */
require_once __DIR__ . '/Controller/tomb.php';
//增加区域
$app->post('/tomb/addzone', function ($request, $response, $args) {
	return handle_tomb_addzone($this,$request, $response, $args);
});

//减少区域
$app->post('/tomb/deletezone', function ($request, $response, $args) {
	return handle_tomb_deletezone($this,$request, $response, $args);
});

//更改行数数量
$app->post('/tomb/updaterow', function ($request, $response, $args) {
	return handle_tomb_updaterow($this,$request, $response, $args);
});

//更改列数数量
$app->post('/tomb/updatecol', function ($request, $response, $args) {
	return handle_tomb_updatecol($this,$request, $response, $args);
});

//请求一个区域所有墓穴信息
$app->get('/tomb/zoneinfo', function ($request, $response, $args) {
	return handle_tomb_zoneinfo($this,$request, $response, $args);
});

//请求单个墓穴信息
$app->get('/tomb/tombinfo', function ($request, $response, $args) {
	return handle_tomb_tombinfo($this,$request, $response, $args);
});

// 墓位信息修改
$app->post('/tomb/update', function ($request, $response, $args) {
	return handle_tomb_update($this,$request, $response, $args);
});

//列出当前所有区
$app->get('/tomb/zonelist', function ($request, $response, $args) {
	return handle_tomb_zonelist($this,$request, $response, $args);
});

//列出所有区域的使用情况
$app->get('/tomb/summary', function ($request, $response, $args) {
	return handle_tomb_summary($this,$request, $response, $args);
});

// 上传墓位文件
$app->post('/tomb/uploadfile', function ($request, $response, $args) {
	return handle_tomb_uploadfile($this,$request, $response, $args);
});

// 删除墓位文件
$app->post('/tomb/deletefile', function ($request, $response, $args) {
	return handle_tomb_deletefile($this,$request, $response, $args);
});

// 列出墓位文件
$app->get('/tomb/listfile', function ($request, $response, $args) {
	return handle_tomb_listfile($this,$request, $response, $args);
});

/*
 * 文件下载请求
 * */
$app->get('/tombfiles/', function ($request, $response, $args) {
	return handle_tombfiles($this,$request, $response, $args);
});


/*
 * 添加墓穴类型
 * */
$app->post('/tomb/addtombtype', function ($request, $response, $args) {
	return handle_tomb_addtombtype($this,$request, $response, $args);
});
/*
 * 删除墓穴类型
 * */
$app->post('/tomb/deletetombtype', function ($request, $response, $args) {
	return handle_tomb_deletetombtype($this,$request, $response, $args);
});
/*
 * 列出所有墓穴类型
 * */
$app->get('/tomb/listtombtype', function ($request, $response, $args) {
	return handle_tomb_listtombtype($this,$request, $response, $args);
});

/*
 * 修改墓穴类型
 * */
$app->post('/tomb/updatetombtype', function ($request, $response, $args) {
	return handle_tomb_updatetombtype($this,$request, $response, $args);
});



/*
 * 新增维修
 * */
$app->post('/tomb/addmaintenance', function ($request, $response, $args) {
	return handle_tomb_addmaintenance($this,$request, $response, $args);
});

/*
 * 修改维修
 * */
$app->post('/tomb/updatemaintenance', function ($request, $response, $args) {
	return handle_tomb_updatemaintenance($this,$request, $response, $args);
});

/*
 * 列出维修
 * */
$app->get('/tomb/listmaintenance', function ($request, $response, $args) {
	return handle_tomb_listmaintenance($this,$request, $response, $args);
});

/*
 * 删除维修
 * */
$app->post('/tomb/deletemaintenance', function ($request, $response, $args) {
	return handle_tomb_deletemaintenance($this,$request, $response, $args);
});

/*
 * 安葬登记
 * */
$app->post('/tomb/updatebury', function ($request, $response, $args) {
	return handle_tomb_updatebury($this,$request, $response, $args);
});

/*
 * 墓穴搜索
 * */
$app->get('/tomb/search', function ($request, $response, $args) {
	return handle_tomb_search($this,$request, $response, $args);
});

/*
 * 墓穴申购管理
 * */
require_once __DIR__ . '/Controller/order.php';

/*
 * 新购申请（墓穴购买）
 * */
$app->post('/order/buy', function ($request, $response, $args) {
	return handle_order_buy($this,$request, $response, $args);
});

/*
 * 新购删除（退墓）
 * */
$app->post('/order/delete', function ($request, $response, $args) {
	return handle_order_delete($this,$request, $response, $args);
}); 

/*
 * 新购查询
 * */
$app->get('/order/info', function ($request, $response, $args) {
	return handle_order_info($this,$request, $response, $args);
});

/*
 * 墓位预定
 * */
$app->post('/order/book', function ($request, $response, $args) {
	return handle_order_book($this,$request, $response, $args);
});
	
/*
 * 墓位转让
 * */
$app->post('/order/transfer', function ($request, $response, $args) {
	return handle_order_book($this,$request, $response, $args);
});

/*
 * 购置费用管理
 * */
require_once __DIR__ . '/Controller/orderfee.php';
/*
 * 新购付费
 * */	
$app->post('/orderfee/pay', function ($request, $response, $args) {
	return handle_orderfee_pay($this,$request, $response, $args);
});
/*
 * 新购付费修改
 * */
$app->post('/orderfee/update', function ($request, $response, $args) {
	return handle_orderfee_update($this,$request, $response, $args);
});
/*
 * 新购付费删除
 * */
$app->post('/orderfee/delete', function ($request, $response, $args) {
	return handle_orderfee_delete($this,$request, $response, $args);
});

/*
 * 管理费用管理
 * */
require_once __DIR__ . '/Controller/managementfee.php';
/*
 * 管理费用付费
 * */
$app->post('/managementfee/pay', function ($request, $response, $args) {
	return handle_managementfee_pay($this,$request, $response, $args);
});

/*
 * 管理费用修改
 * */
$app->post('/managementfee/update', function ($request, $response, $args) {
	return handle_managementfee_update($this,$request, $response, $args);
});
/*
 * 管理费用删除
 * */
$app->post('/managementfee/delete', function ($request, $response, $args) {
	return handle_managementfee_delete($this,$request, $response, $args);
});

/*
 * 管理费用搜索
 * */
$app->get('/managementfee/search', function ($request, $response, $args) {
	return handle_managementfee_search($this,$request, $response, $args);
});
